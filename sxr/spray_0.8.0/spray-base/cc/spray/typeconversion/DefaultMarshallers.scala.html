<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>cc/spray/typeconversion/DefaultMarshallers.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright (C) 2011 Mathias Doenitz
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

<span class="keyword">package</span> cc.spray
<span class="keyword">package</span> typeconversion

<span class="keyword">import</span> http._
<span class="keyword">import</span> <a href="../http/MediaType.scala.html#9667" title="object cc.spray.http.MediaTypes">MediaTypes</a>._
<span class="keyword">import</span> <a href="../http/HttpCharset.scala.html#9553" title="object cc.spray.http.HttpCharsets">HttpCharsets</a>._
<span class="keyword">import</span> xml.NodeSeq
<span class="keyword">import</span> java.nio.CharBuffer

<span class="keyword">trait</span> <a title="trait DefaultMarshallers extends java.lang.Object with cc.spray.typeconversion.MultipartMarshallers with ScalaObject" id="9852">DefaultMarshallers</a> <span title="ScalaObject" class="keyword">extends</span> <a href="MultipartMarshallers.scala.html#9932" title="cc.spray.typeconversion.MultipartMarshallers">MultipartMarshallers</a> <span class="delimiter">{</span>

  <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="cc.spray.typeconversion.MarshallerBase[String]" id="87707">StringMarshaller</a> = <a href="#87719" title="cc.spray.typeconversion.MarshallerBase[String]{}" class="keyword">new</a> <a title="anonymous class $anon extends cc.spray.typeconversion.MarshallerBase[String]" id="87719">MarshallerBase</a><span class="delimiter">[</span>String<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="List[cc.spray.http.ContentType]" id="87725">canMarshalTo</a> = <a href="../http/ContentType.scala.html#25287" title="(mediaType: cc.spray.http.MediaType)cc.spray.http.ContentType">ContentType</a><span class="delimiter">(</span><a href="../http/MediaType.scala.html#22963" title="=&gt; cc.spray.http.MediaType">`text/plain`</a><span class="delimiter">)</span> <a href="#87728" title="(x: cc.spray.http.ContentType)List[cc.spray.http.ContentType]">::</a> <span title="object Nil">Nil</span>

    <span class="keyword">def</span> <a title="(value: String, contentType: cc.spray.http.ContentType)cc.spray.http.HttpContent" id="87727">marshal</a><span class="delimiter">(</span><a title="String" id="87742">value</a>: <span title="String">String</span>, <a title="cc.spray.http.ContentType" id="87743">contentType</a>: <a href="../http/ContentType.scala.html#9532" title="cc.spray.http.ContentType">ContentType</a><span class="delimiter">)</span> = <a href="../http/HttpContent.scala.html#25370" title="(contentType: cc.spray.http.ContentType, string: String)cc.spray.http.HttpContent">HttpContent</a><span class="delimiter">(</span><a href="#87743" title="cc.spray.http.ContentType">contentType</a>, <a href="#87742" title="String">value</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="cc.spray.typeconversion.MarshallerBase[Array[Char]]" id="87709">CharArrayMarshaller</a> = <a href="#88089" title="cc.spray.typeconversion.MarshallerBase[Array[Char]]{}" class="keyword">new</a> <a title="anonymous class $anon extends cc.spray.typeconversion.MarshallerBase[Array[Char]]" id="88089">MarshallerBase</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="List[cc.spray.http.ContentType]" id="88091">canMarshalTo</a> = <a href="../http/ContentType.scala.html#25287" title="(mediaType: cc.spray.http.MediaType)cc.spray.http.ContentType">ContentType</a><span class="delimiter">(</span><a href="../http/MediaType.scala.html#22963" title="=&gt; cc.spray.http.MediaType">`text/plain`</a><span class="delimiter">)</span> <a href="#88094" title="(x: cc.spray.http.ContentType)List[cc.spray.http.ContentType]">::</a> <span title="object Nil">Nil</span>

    <span class="keyword">def</span> <a title="(value: Array[Char], contentType: cc.spray.http.ContentType)cc.spray.http.HttpContent" id="88093">marshal</a><span class="delimiter">(</span><a title="Array[Char]" id="88106">value</a>: <span title="Array[Char]">Array</span><span class="delimiter">[</span>Char<span class="delimiter">]</span>, <a title="cc.spray.http.ContentType" id="88107">contentType</a>: <a href="../http/ContentType.scala.html#9532" title="cc.spray.http.ContentType">ContentType</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="java.nio.charset.Charset" id="88110">nioCharset</a> = <a href="#88107" title="cc.spray.http.ContentType">contentType</a>.<a href="../http/ContentType.scala.html#25273" title="=&gt; Option[cc.spray.http.HttpCharset]">charset</a>.<span title="(default: =&gt; cc.spray.http.HttpCharset)cc.spray.http.HttpCharset">getOrElse</span><span class="delimiter">(</span><a href="../http/HttpCharset.scala.html#24897" title="=&gt; cc.spray.http.HttpCharset">`ISO-8859-1`</a><span class="delimiter">)</span>.<a href="../http/HttpCharset.scala.html#29948" title="=&gt; java.nio.charset.Charset">nioCharset</a>
      <span class="keyword">val</span> <a title="java.nio.CharBuffer" id="88111">charBuffer</a> = <span title="object java.nio.CharBuffer">CharBuffer</span>.<span title="(x$1: Array[Char])java.nio.CharBuffer">wrap</span><span class="delimiter">(</span><a href="#88106" title="Array[Char]">value</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="java.nio.ByteBuffer" id="88112">byteBuffer</a> = <a href="#88110" title="java.nio.charset.Charset">nioCharset</a>.<span title="(x$1: java.nio.CharBuffer)java.nio.ByteBuffer">encode</span><span class="delimiter">(</span><a href="#88111" title="java.nio.CharBuffer">charBuffer</a><span class="delimiter">)</span>
      <a href="../http/HttpContent.scala.html#25371" title="(contentType: cc.spray.http.ContentType, buffer: Array[Byte])cc.spray.http.HttpContent">HttpContent</a><span class="delimiter">(</span><a href="#88107" title="cc.spray.http.ContentType">contentType</a>, <a href="#88112" title="java.nio.ByteBuffer">byteBuffer</a>.<span title="()Array[Byte]">array</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="cc.spray.typeconversion.MarshallerBase[scala.xml.NodeSeq]" id="87711">NodeSeqMarshaller</a> = <a href="#88150" title="cc.spray.typeconversion.MarshallerBase[scala.xml.NodeSeq]{}" class="keyword">new</a> <a title="anonymous class $anon extends cc.spray.typeconversion.MarshallerBase[scala.xml.NodeSeq]" id="88150">MarshallerBase</a><span class="delimiter">[</span>NodeSeq<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="List[cc.spray.http.ContentType]" id="88152">canMarshalTo</a> = <a href="../http/ContentType.scala.html#25287" title="(mediaType: cc.spray.http.MediaType)cc.spray.http.ContentType">ContentType</a><span class="delimiter">(</span><a href="../http/MediaType.scala.html#22965" title="=&gt; cc.spray.http.MediaType">`text/xml`</a><span class="delimiter">)</span> <a href="#88155" title="(x: cc.spray.http.ContentType)List[cc.spray.http.ContentType]">::</a>
                       <a href="../http/ContentType.scala.html#25287" title="(mediaType: cc.spray.http.MediaType)cc.spray.http.ContentType">ContentType</a><span class="delimiter">(</span><a href="../http/MediaType.scala.html#22959" title="=&gt; cc.spray.http.MediaType">`text/html`</a><span class="delimiter">)</span> <a href="#88162" title="(x: cc.spray.http.ContentType)List[cc.spray.http.ContentType]">::</a>
                       <a href="../http/ContentType.scala.html#25287" title="(mediaType: cc.spray.http.MediaType)cc.spray.http.ContentType">ContentType</a><span class="delimiter">(</span><a href="../http/MediaType.scala.html#22899" title="=&gt; cc.spray.http.MediaType">`application/xhtml+xml`</a><span class="delimiter">)</span> <a href="#88169" title="(x: cc.spray.http.ContentType)List[cc.spray.http.ContentType]">::</a> <span title="object Nil">Nil</span>

    <span class="keyword">def</span> <a title="(value: scala.xml.NodeSeq, contentType: cc.spray.http.ContentType)cc.spray.http.HttpContent" id="88154">marshal</a><span class="delimiter">(</span><a title="scala.xml.NodeSeq" id="88187">value</a>: <span title="scala.xml.NodeSeq">NodeSeq</span>, <a title="cc.spray.http.ContentType" id="88188">contentType</a>: <a href="../http/ContentType.scala.html#9532" title="cc.spray.http.ContentType">ContentType</a><span class="delimiter">)</span> = <a href="#87707" title="=&gt; cc.spray.typeconversion.MarshallerBase[String]">StringMarshaller</a>.<a href="MarshallerBase.scala.html#87723" title="(value: String, contentType: cc.spray.http.ContentType)cc.spray.http.HttpContent">marshal</a><span class="delimiter">(</span><a href="#88187" title="scala.xml.NodeSeq">value</a>.<span title="()String">toString</span>, <a href="#88188" title="cc.spray.http.ContentType">contentType</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="cc.spray.typeconversion.MarshallerBase[cc.spray.http.FormData]" id="87713">FormDataMarshaller</a> = <a href="#88211" title="cc.spray.typeconversion.MarshallerBase[cc.spray.http.FormData]{}" class="keyword">new</a> <a title="anonymous class $anon extends cc.spray.typeconversion.MarshallerBase[cc.spray.http.FormData]" id="88211">MarshallerBase</a><span class="delimiter">[</span>FormData<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="List[cc.spray.http.ContentType]" id="88213">canMarshalTo</a> = <a href="../http/ContentType.scala.html#25287" title="(mediaType: cc.spray.http.MediaType)cc.spray.http.ContentType">ContentType</a><span class="delimiter">(</span><a href="../http/MediaType.scala.html#22907" title="=&gt; cc.spray.http.MediaType">`application/x-www-form-urlencoded`</a><span class="delimiter">)</span> <a href="#88216" title="(x: cc.spray.http.ContentType)List[cc.spray.http.ContentType]">::</a> <span title="object Nil">Nil</span>

    <span class="keyword">def</span> <a title="(formContent: cc.spray.http.FormData, contentType: cc.spray.http.ContentType)cc.spray.http.HttpContent" id="88215">marshal</a><span class="delimiter">(</span><a title="cc.spray.http.FormData" id="88228">formContent</a>: <a href="../http/MultipartContent.scala.html#9682" title="cc.spray.http.FormData">FormData</a>, <a title="cc.spray.http.ContentType" id="88229">contentType</a>: <a href="../http/ContentType.scala.html#9532" title="cc.spray.http.ContentType">ContentType</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">import</span> java.net.<span title="object java.net.URLEncoder">URLEncoder</span>.encode
      <span class="keyword">val</span> <a title="String" id="88233">charset</a> = <a href="#88229" title="cc.spray.http.ContentType">contentType</a>.<a href="../http/ContentType.scala.html#25273" title="=&gt; Option[cc.spray.http.HttpCharset]">charset</a>.<span title="(default: =&gt; cc.spray.http.HttpCharset)cc.spray.http.HttpCharset">getOrElse</span><span class="delimiter">(</span><a href="../http/HttpCharset.scala.html#24897" title="=&gt; cc.spray.http.HttpCharset">`ISO-8859-1`</a><span class="delimiter">)</span>.<a href="../http/HttpCharset.scala.html#29950" title="=&gt; Seq[String]">aliases</a>.<span title="=&gt; String">head</span>
      <span class="keyword">val</span> <a title="scala.collection.immutable.Iterable[java.lang.String]" id="88234">keyValuePairs</a> = <a href="#88228" title="cc.spray.http.FormData">formContent</a>.<a href="../http/MultipartContent.scala.html#34692" title="=&gt; Map[String,String]">fields</a>.<span title="(f: (String, String) =&gt; java.lang.String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Map[String,String],java.lang.String,scala.collection.immutable.Iterable[java.lang.String]])scala.collection.immutable.Iterable[java.lang.String]">map</span> <a href="#88268" title="java.lang.String" class="delimiter">{</a>
        <span class="keyword">case</span> <span title="java.lang.String" class="delimiter">(</span><a title="String" id="88271">key</a>, <a title="String" id="88272">value</a><span class="delimiter">)</span> =&gt; <span title="(x$1: java.lang.String, x$2: java.lang.String)java.lang.String">encode</span><span class="delimiter">(</span><a href="#88271" title="String">key</a>, <a href="#88233" title="String">charset</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="Char(\'=\')" class="char">'='</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="(x$1: java.lang.String, x$2: java.lang.String)java.lang.String">encode</span><span class="delimiter">(</span><a href="#88272" title="String">value</a>, <a href="#88233" title="String">charset</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#87707" title="=&gt; cc.spray.typeconversion.MarshallerBase[String]">StringMarshaller</a>.<a href="MarshallerBase.scala.html#87723" title="(value: String, contentType: cc.spray.http.ContentType)cc.spray.http.HttpContent">marshal</a><span class="delimiter">(</span><a href="#88234" title="scala.collection.immutable.Iterable[java.lang.String]">keyValuePairs</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&amp;&quot;)" class="string">&quot;&amp;&quot;</span><span class="delimiter">)</span>, <a href="#88229" title="cc.spray.http.ContentType">contentType</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">// As a fallback we allow marshalling without content negotiation from objects that are implicitly convertible to</span>
  <span class="comment">// HttpContent (most notably HttpContent itself). Note that relying on this might make the application not HTTP spec</span>
  <span class="comment">// conformant since the Accept headers the client sent with the request are completely ignored</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T](implicit converter: T =&gt; cc.spray.http.HttpContent)java.lang.Object with cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[T]{def apply(selector: cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType]): cc.spray.typeconversion.MarshalWith[T]}" id="87715">view2Marshaller</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="87717">T</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="T =&gt; cc.spray.http.HttpContent" id="88331">converter</a>: T =&gt; HttpContent<span class="delimiter">)</span> = <a href="#88334" title="java.lang.Object with cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[T]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[T]" id="88334">Marshaller</a><span class="delimiter">[</span>T<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(selector: cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType])cc.spray.typeconversion.MarshalWith[T]" id="88336">apply</a><span class="delimiter">(</span><a title="cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType]" id="88337">selector</a>: <span title="cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType]">ContentTypeSelector</span><span class="delimiter">)</span> = <a href="Marshalling.scala.html#88343" title="(f: T =&gt; cc.spray.http.HttpContent)cc.spray.typeconversion.MarshalWith[T]">MarshalWith</a><span class="delimiter">(</span><a href="#88331" title="T =&gt; cc.spray.http.HttpContent">converter</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object cc.spray.typeconversion.DefaultMarshallers" id="9853">DefaultMarshallers</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9852" title="cc.spray.typeconversion.DefaultMarshallers">DefaultMarshaller</a>s
        </pre>
    </body>
</html>