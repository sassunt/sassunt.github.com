<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>cc/spray/examples/calculator/CalculatorService.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> cc.spray
<span class="keyword">package</span> examples.calculator

<span class="keyword">import</span> directives.DoubleNumber

<span class="keyword">trait</span> <a title="trait CalculatorService extends java.lang.Object with cc.spray.Directives with cc.spray.examples.calculator.CustomMarshallers with ScalaObject" id="9908">CalculatorService</a> <span title="ScalaObject" class="keyword">extends</span> <span title="cc.spray.Directives">Directives</span> <span class="keyword">with</span> <a href="CustomMarshallers.scala.html#9915" title="cc.spray.examples.calculator.CustomMarshallers">CustomMarshallers</a> <span class="delimiter">{</span>
  
  <span class="keyword">val</span> <a title="cc.spray.RequestContext =&gt; Unit" id="12401">calculatorService</a> = <span class="delimiter">{</span>
    <a href="#9908" title="(pattern: cc.spray.directives.PathMatcher2[Double,Double])cc.spray.directives.SprayRoute2[Double,Double]">path</a><span title="(routing: (Double, Double) =&gt; cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><a href="#9908" title="implicit cc.spray.directives.PathDirectives.string2Matcher : (s: String)cc.spray.directives.PathMatcher0" class="string">&quot;add&quot;</a> <span title="(sub: cc.spray.directives.PathMatcher1[Double])cc.spray.directives.Combi[(Double,)] with cc.spray.directives.PathMatcher1[Double]">/</span> <span title="object cc.spray.directives.DoubleNumber">DoubleNumber</span> <span title="(sub: cc.spray.directives.PathMatcher1[Double])cc.spray.directives.Combi[(Double, Double)] with cc.spray.directives.PathMatcher2[Double,Double]">/</span> <span title="object cc.spray.directives.DoubleNumber">DoubleNumber</span><span class="delimiter">)</span> <a href="#9908" title="implicit cc.spray.directives.MiscDirectives.pimpRouteWithConcatenation : (route: cc.spray.RequestContext =&gt; Unit)CalculatorService.this.RouteConcatenation" class="delimiter">{</a> <span class="delimiter">(</span><a title="Double" id="27669">a</a>, <a title="Double" id="27670">b</a><span class="delimiter">)</span> =&gt;
      <a href="#9908" title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit">get</a> <span class="delimiter">{</span>
        <a href="#27679" title="cc.spray.RequestContext">_</a>.<span title="(obj: Double)(implicit evidence$1: cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[Double])Unit">complete</span><a href="CustomMarshallers.scala.html#13082" title="object CalculatorService.this.DoubleMarshaller" class="delimiter">(</a><a href="#27669" title="Double">a</a> <span title="(x: Double)Double">+</span> <a href="#27670" title="Double">b</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <a href="#9908" title="implicit cc.spray.directives.MiscDirectives.pimpRouteWithConcatenation : (route: cc.spray.RequestContext =&gt; Unit)CalculatorService.this.RouteConcatenation">~</a>
    <a href="#9908" title="(pattern: cc.spray.directives.PathMatcher0)cc.spray.directives.SprayRoute0">pathPrefix</a><span title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><a href="#9908" title="implicit cc.spray.directives.PathDirectives.string2Matcher : (s: String)cc.spray.directives.PathMatcher0" class="string">&quot;substract&quot;</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#9908" title="(pattern: cc.spray.directives.PathMatcher1[Double])cc.spray.directives.SprayRoute1[Double]">pathPrefix</a><span title="(routing: Double =&gt; cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><span title="object cc.spray.directives.DoubleNumber">DoubleNumber</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a title="Double" id="29758">a</a> =&gt;
        <a href="#9908" title="(pattern: cc.spray.directives.PathMatcher1[Double])cc.spray.directives.SprayRoute1[Double]">path</a><span title="(routing: Double =&gt; cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><span title="object cc.spray.directives.DoubleNumber">DoubleNumber</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a title="Double" id="29822">b</a> =&gt; <span class="comment">// pathPrefix can be nested, but the final match needs to be done with the &quot;path&quot; directive</span>
          <a href="#9908" title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit">get</a> <span class="delimiter">{</span>
            <a href="#29831" title="cc.spray.RequestContext">_</a>.<span title="(obj: Double)(implicit evidence$1: cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[Double])Unit">complete</span><a href="CustomMarshallers.scala.html#13082" title="object CalculatorService.this.DoubleMarshaller" class="delimiter">(</a><a href="#29758" title="Double">a</a> <span title="(x: Double)Double">-</span> <a href="#29822" title="Double">b</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <a href="#9908" title="implicit cc.spray.directives.MiscDirectives.pimpRouteWithConcatenation : (route: cc.spray.RequestContext =&gt; Unit)CalculatorService.this.RouteConcatenation">~</a>
    <a href="#9908" title="(pattern: cc.spray.directives.PathMatcher2[Double,Double])cc.spray.directives.SprayRoute2[Double,Double]">path</a><span title="(routing: (Double, Double) =&gt; cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><a href="#9908" title="implicit cc.spray.directives.PathDirectives.string2Matcher : (s: String)cc.spray.directives.PathMatcher0" class="string">&quot;multiply&quot;</a> <span title="(sub: cc.spray.directives.PathMatcher1[Double])cc.spray.directives.Combi[(Double,)] with cc.spray.directives.PathMatcher1[Double]">/</span> <span title="object cc.spray.directives.DoubleNumber">DoubleNumber</span> <span title="(sub: cc.spray.directives.PathMatcher1[Double])cc.spray.directives.Combi[(Double, Double)] with cc.spray.directives.PathMatcher2[Double,Double]">/</span> <span title="object cc.spray.directives.DoubleNumber">DoubleNumber</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="Double" id="30168">a</a>, <a title="Double" id="30169">b</a><span class="delimiter">)</span> =&gt;
      <a href="#9908" title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit">detach</a> <span class="delimiter">{</span> <span class="comment">// just for fun: everything following the 'detach' directive will be running in a newly spawned actor  </span>
        <a href="#9908" title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit">get</a> <span class="delimiter">{</span>
          <a href="#30189" title="cc.spray.RequestContext">_</a>.<span title="(obj: Double)(implicit evidence$1: cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[Double])Unit">complete</span><a href="CustomMarshallers.scala.html#13082" title="object CalculatorService.this.DoubleMarshaller" class="delimiter">(</a><a href="#30168" title="Double">a</a> <span title="(x: Double)Double">*</span> <a href="#30169" title="Double">b</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span title="(other: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit">~</span>
    <a href="#9908" title="(pattern: cc.spray.directives.PathMatcher2[Double,Double])cc.spray.directives.SprayRoute2[Double,Double]">path</a><span title="(routing: (Double, Double) =&gt; cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><a href="#9908" title="implicit cc.spray.directives.PathDirectives.string2Matcher : (s: String)cc.spray.directives.PathMatcher0" class="string">&quot;divide&quot;</a> <span title="(sub: cc.spray.directives.PathMatcher1[Double])cc.spray.directives.Combi[(Double,)] with cc.spray.directives.PathMatcher1[Double]">/</span> <span title="object cc.spray.directives.DoubleNumber">DoubleNumber</span> <span title="(sub: cc.spray.directives.PathMatcher1[Double])cc.spray.directives.Combi[(Double, Double)] with cc.spray.directives.PathMatcher2[Double,Double]">/</span> <span title="object cc.spray.directives.DoubleNumber">DoubleNumber</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="Double" id="30526">a</a>, <a title="Double" id="30527">b</a><span class="delimiter">)</span> =&gt;
      <a href="#9908" title="(pm: CalculatorService.this.PM[java.lang.String])cc.spray.directives.SprayRoute1[java.lang.String]">parameter</a><span title="(routing: java.lang.String =&gt; cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><a href="#9908" title="implicit cc.spray.directives.ReceptaclePimps.fromSymbol : (name: Symbol)cc.spray.directives.NameReceptacle[String]" class="symbol">'onDivZero</a> <a href="#9908" title="(r: cc.spray.directives.NameDefaultReceptacle[java.lang.String])(implicit evidence$2: cc.spray.typeconversion.package.FromStringOptionDeserializer[java.lang.String])cc.spray.directives.ParameterMatcher[java.lang.String]">?</a> <span title="java.lang.String(&quot;Cannot divide by zero&quot;)" class="string">&quot;Cannot divide by zero&quot;</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a title="java.lang.String" id="33686">onDivZero</a> =&gt;
        <a href="#9908" title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit">get</a> <span class="delimiter">{</span> <a title="cc.spray.RequestContext" id="33695">ctx</a> =&gt;
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#30527" title="Double">b</a> <span title="(x: Double)Boolean">==</span> <span title="Double(0.0)" class="double">0.0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#33695" title="cc.spray.RequestContext">ctx</a>.<span title="(obj: java.lang.String)(implicit evidence$1: cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[java.lang.String])Unit">complete</span><a href="#9908" title="=&gt; cc.spray.typeconversion.MarshallerBase[String]" class="delimiter">(</a><a href="#33686" title="java.lang.String">onDivZero</a><span class="delimiter">)</span> <span class="comment">// we allow for an optional &quot;onDivZero&quot; parameter to supply the error result</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="#33695" title="cc.spray.RequestContext">ctx</a>.<span title="(obj: Double)(implicit evidence$1: cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[Double])Unit">complete</span><a href="CustomMarshallers.scala.html#13082" title="object CalculatorService.this.DoubleMarshaller" class="delimiter">(</a><a href="#30526" title="Double">a</a> <span title="(x: Double)Double">/</span> <a href="#30527" title="Double">b</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
<span class="delimiter">}</span>
        </pre>
    </body>
</html>