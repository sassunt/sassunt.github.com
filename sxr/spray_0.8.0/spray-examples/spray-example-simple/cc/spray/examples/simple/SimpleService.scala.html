<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>cc/spray/examples/simple/SimpleService.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> cc.spray
<span class="keyword">package</span> examples.simple

<span class="keyword">import</span> utils.<span title="object cc.spray.utils.ActorHelpers">ActorHelpers</span>._
<span class="keyword">import</span> http.<span title="object cc.spray.http.MediaTypes">MediaTypes</span>._
<span class="keyword">import</span> java.util.concurrent.TimeUnit
<span class="keyword">import</span> akka.actor.<span class="delimiter">{</span>Scheduler, Actor, Kill<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait SimpleService extends java.lang.Object with cc.spray.Directives with ScalaObject" id="9912">SimpleService</a> <span title="ScalaObject" class="keyword">extends</span> <span title="cc.spray.Directives">Directives</span> <span class="delimiter">{</span>

  <span class="keyword">val</span> <a title="cc.spray.RequestContext =&gt; Unit" id="13697">simpleService</a> = <span class="delimiter">{</span>
    <a href="#9912" title="(pattern: cc.spray.directives.PathMatcher0)cc.spray.directives.SprayRoute0">path</a><span title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><a href="#9912" title="implicit cc.spray.directives.PathDirectives.string2Matcher : (s: String)cc.spray.directives.PathMatcher0" class="string">&quot;&quot;</a><span class="delimiter">)</span> <a href="#9912" title="implicit cc.spray.directives.MiscDirectives.pimpRouteWithConcatenation : (route: cc.spray.RequestContext =&gt; Unit)SimpleService.this.RouteConcatenation" class="delimiter">{</a>
      <a href="#9912" title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit">get</a> <span class="delimiter">{</span>
        <a href="#9912" title="(mediaType: cc.spray.http.MediaType)cc.spray.directives.SprayRoute0">respondWithMediaType</a><span title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><span title="=&gt; cc.spray.http.MediaType">`text/html`</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#28285" title="cc.spray.RequestContext">_</a>.<span title="(obj: scala.xml.Elem)(implicit evidence$1: cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[scala.xml.Elem])Unit">complete</span> <a href="#9912" title="=&gt; cc.spray.typeconversion.MarshallerBase[scala.xml.NodeSeq]" class="delimiter">{</a>
            &lt;<a title="scala.xml.Elem" id="29824">html</a>&gt;
              &lt;<a title="scala.xml.Elem" id="30924">body</a>&gt;
                &lt;<a title="scala.xml.Elem" id="30925">h1</a>&gt;<span title="scala.xml.Text">Say</span> hello to &lt;<a title="scala.xml.Elem" id="30926">i</a>&gt;<span title="scala.xml.Text">spray</span>&lt;/i&gt;!&lt;/h1&gt;
                &lt;<a title="scala.xml.Elem" id="30955">p</a>&gt;<span title="scala.xml.Text">Defined</span> resources:&lt;/p&gt;
                &lt;<a title="scala.xml.Elem" id="30956">ul</a>&gt;
                  &lt;<a title="scala.xml.Elem" id="30957">li</a>&gt;&lt;<a title="scala.xml.MetaData" id="31068">a</a> href=<span title="scala.xml.Text" class="string">&quot;/ping&quot;</span>&gt;/ping&lt;/a&gt;&lt;/li&gt;
                  &lt;<a title="scala.xml.Elem" id="31069">li</a>&gt;&lt;<a title="scala.xml.MetaData" id="31075">a</a> href=<span title="scala.xml.Text" class="string">&quot;/crashRootService&quot;</span>&gt;/crashRootService&lt;/a&gt;&lt;/li&gt;
                  &lt;<a title="scala.xml.Elem" id="31076">li</a>&gt;&lt;<a title="scala.xml.MetaData" id="31082">a</a> href=<span title="scala.xml.Text" class="string">&quot;/crashHttpService&quot;</span>&gt;/crashHttpService&lt;/a&gt;&lt;/li&gt;
                  &lt;<a title="scala.xml.Elem" id="31083">li</a>&gt;&lt;<a title="scala.xml.MetaData" id="31089">a</a> href=<span title="scala.xml.Text" class="string">&quot;/timeout&quot;</span>&gt;/timeout&lt;/a&gt;&lt;/li&gt;
                  &lt;<a title="scala.xml.Elem" id="31090">li</a>&gt;&lt;<a title="scala.xml.MetaData" id="31096">a</a> href=<span title="scala.xml.Text" class="string">&quot;/stop&quot;</span>&gt;/stop&lt;/a&gt;&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/body&gt;
            &lt;/html&gt;
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <a href="#9912" title="implicit cc.spray.directives.MiscDirectives.pimpRouteWithConcatenation : (route: cc.spray.RequestContext =&gt; Unit)SimpleService.this.RouteConcatenation">~</a>
    <a href="#9912" title="(pattern: cc.spray.directives.PathMatcher0)cc.spray.directives.SprayRoute0">path</a><span title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><a href="#9912" title="implicit cc.spray.directives.PathDirectives.string2Matcher : (s: String)cc.spray.directives.PathMatcher0" class="string">&quot;ping&quot;</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#9912" title="(unmarshaller: cc.spray.typeconversion.package.Unmarshaller[Option[String]])cc.spray.directives.SprayRoute1[Option[String]]">content</a><span title="(routing: Option[String] =&gt; cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><a href="#9912" title="[A](implicit evidence$1: cc.spray.typeconversion.package.Unmarshaller[A])cc.spray.typeconversion.package.Unmarshaller[A]">as</a><a href="#9912" title="(implicit evidence$1: cc.spray.typeconversion.package.Unmarshaller[Option[String]])cc.spray.typeconversion.package.Unmarshaller[Option[String]]" class="delimiter">[</a><span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a title="Option[String]" id="34491">body</a> =&gt;
        <a href="#34493" title="cc.spray.RequestContext">_</a>.<span title="(obj: java.lang.String)(implicit evidence$1: cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[java.lang.String])Unit">complete</span><a href="#9912" title="=&gt; cc.spray.typeconversion.MarshallerBase[String]" class="delimiter">(</a><span title="java.lang.String(&quot;PONG! &quot;)" class="string">&quot;PONG! &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#34491" title="Option[String]">body</a>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <a href="#9912" title="implicit cc.spray.directives.MiscDirectives.pimpRouteWithConcatenation : (route: cc.spray.RequestContext =&gt; Unit)SimpleService.this.RouteConcatenation">~</a>
    <a href="#9912" title="(pattern: cc.spray.directives.PathMatcher0)cc.spray.directives.SprayRoute0">path</a><span title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><a href="#9912" title="implicit cc.spray.directives.PathDirectives.string2Matcher : (s: String)cc.spray.directives.PathMatcher0" class="string">&quot;crashRootService&quot;</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#9912" title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit">get</a> <span class="delimiter">{</span> <a title="cc.spray.RequestContext" id="34735">ctx</a> =&gt;
        <a href="#34735" title="cc.spray.RequestContext">ctx</a>.<span title="(obj: java.lang.String)(implicit evidence$1: cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[java.lang.String])Unit">complete</span><a href="#9912" title="=&gt; cc.spray.typeconversion.MarshallerBase[String]" class="delimiter">(</a><span title="java.lang.String(&quot;About to kill the RootService...&quot;)" class="string">&quot;About to kill the RootService...&quot;</span><span class="delimiter">)</span>
        <span title="(id: String)akka.actor.ActorRef">actor</span><span class="delimiter">(</span><span title="java.lang.String(&quot;spray-root-service&quot;)" class="string">&quot;spray-root-service&quot;</span><span class="delimiter">)</span> <span title="(msg: Any)(implicit sender: akka.actor.UntypedChannel)Unit">!</span> <span title="object akka.actor.Kill">Kill</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <a href="#9912" title="implicit cc.spray.directives.MiscDirectives.pimpRouteWithConcatenation : (route: cc.spray.RequestContext =&gt; Unit)SimpleService.this.RouteConcatenation">~</a>
    <a href="#9912" title="(pattern: cc.spray.directives.PathMatcher0)cc.spray.directives.SprayRoute0">path</a><span title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><a href="#9912" title="implicit cc.spray.directives.PathDirectives.string2Matcher : (s: String)cc.spray.directives.PathMatcher0" class="string">&quot;crashHttpService&quot;</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#9912" title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit">get</a> <span class="delimiter">{</span> <a title="cc.spray.RequestContext" id="35035">ctx</a> =&gt;
        <a href="#35035" title="cc.spray.RequestContext">ctx</a>.<span title="(obj: java.lang.String)(implicit evidence$1: cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[java.lang.String])Unit">complete</span><a href="#9912" title="=&gt; cc.spray.typeconversion.MarshallerBase[String]" class="delimiter">(</a><span title="java.lang.String(&quot;About to kill the HttpService...&quot;)" class="string">&quot;About to kill the HttpService...&quot;</span><span class="delimiter">)</span>
        <span title="object akka.actor.Actor">Actor</span>.<span title="=&gt; akka.actor.ActorRegistry">registry</span>.<span title="[T &lt;: akka.actor.Actor](implicit manifest: scala.reflect.Manifest[T])Array[akka.actor.ActorRef]">actorsFor</span><span title="(xs: Array[akka.actor.ActorRef])scala.collection.mutable.ArrayOps[akka.actor.ActorRef]" class="delimiter">[</span><span title="cc.spray.HttpService">HttpService</span><span class="delimiter">]</span>.<span title="=&gt; akka.actor.ActorRef">head</span> <span title="(msg: Any)(implicit sender: akka.actor.UntypedChannel)Unit">!</span> <span title="object akka.actor.Kill">Kill</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <a href="#9912" title="implicit cc.spray.directives.MiscDirectives.pimpRouteWithConcatenation : (route: cc.spray.RequestContext =&gt; Unit)SimpleService.this.RouteConcatenation">~</a>
    <a href="#9912" title="(pattern: cc.spray.directives.PathMatcher0)cc.spray.directives.SprayRoute0">path</a><span title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><a href="#9912" title="implicit cc.spray.directives.PathDirectives.string2Matcher : (s: String)cc.spray.directives.PathMatcher0" class="string">&quot;timeout&quot;</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#9912" title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit">get</a> <span class="delimiter">{</span> <a title="cc.spray.RequestContext" id="36209">ctx</a> =&gt;
        <span title="object akka.actor.Scheduler">Scheduler</span>.<span title="(f: () =&gt; Unit, delay: Long, timeUnit: java.util.concurrent.TimeUnit)java.util.concurrent.ScheduledFuture[AnyRef]">scheduleOnce</span><span title="Unit" class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#36209" title="cc.spray.RequestContext">ctx</a>.<span title="(obj: java.lang.String)(implicit evidence$1: cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[java.lang.String])Unit">complete</span><a href="#9912" title="=&gt; cc.spray.typeconversion.MarshallerBase[String]" class="delimiter">(</a><span title="java.lang.String(&quot;Too late!&quot;)" class="string">&quot;Too late!&quot;</span><span class="delimiter">)</span>, <span title="Long(1500L)" class="int">1500</span>, TimeUnit.<span title="java.util.concurrent.TimeUnit(value MILLISECONDS)">MILLISECONDS</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span title="(other: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit">~</span>
    <a href="#9912" title="(pattern: cc.spray.directives.PathMatcher0)cc.spray.directives.SprayRoute0">path</a><span title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><a href="#9912" title="implicit cc.spray.directives.PathDirectives.string2Matcher : (s: String)cc.spray.directives.PathMatcher0" class="string">&quot;stop&quot;</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#9912" title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit">get</a> <span class="delimiter">{</span> <a title="cc.spray.RequestContext" id="36670">ctx</a> =&gt;
        <a href="#36670" title="cc.spray.RequestContext">ctx</a>.<span title="(obj: java.lang.String)(implicit evidence$1: cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[java.lang.String])Unit">complete</span><a href="#9912" title="=&gt; cc.spray.typeconversion.MarshallerBase[String]" class="delimiter">(</a><span title="java.lang.String(&quot;Stopping all actors...&quot;)" class="string">&quot;Stopping all actors...&quot;</span><span class="delimiter">)</span>
        <span title="object akka.actor.Scheduler">Scheduler</span>.<span title="(f: () =&gt; Unit, delay: Long, timeUnit: java.util.concurrent.TimeUnit)java.util.concurrent.ScheduledFuture[AnyRef]">scheduleOnce</span><span title="Unit" class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span title="object akka.actor.Actor">Actor</span>.<span title="=&gt; akka.actor.ActorRegistry">registry</span>.<span title="()Unit">shutdownAll</span><span class="delimiter">(</span><span class="delimiter">)</span>, <span title="Long(100L)" class="int">100</span>, TimeUnit.<span title="java.util.concurrent.TimeUnit(value MILLISECONDS)">MILLISECONDS</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">val</span> <a title="cc.spray.RequestContext =&gt; Unit" id="13699">secondService</a> = <span class="delimiter">{</span>
    <a href="#9912" title="(pattern: cc.spray.directives.PathMatcher0)cc.spray.directives.SprayRoute0">path</a><span title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit" class="delimiter">(</span><a href="#9912" title="implicit cc.spray.directives.PathDirectives.string2Matcher : (s: String)cc.spray.directives.PathMatcher0" class="string">&quot;2nd&quot;</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#9912" title="(route: cc.spray.RequestContext =&gt; Unit)cc.spray.RequestContext =&gt; Unit">get</a> <span class="delimiter">{</span>
        <a href="#36959" title="cc.spray.RequestContext">_</a>.<span title="(obj: java.lang.String)(implicit evidence$1: cc.spray.http.ContentType =&gt; Option[cc.spray.http.ContentType] =&gt; cc.spray.typeconversion.Marshalling[java.lang.String])Unit">complete</span><a href="#9912" title="=&gt; cc.spray.typeconversion.MarshallerBase[String]" class="delimiter">(</a><span title="java.lang.String(&quot;A reply from a second service!&quot;)" class="string">&quot;A reply from a second service!&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>
        </pre>
    </body>
</html>